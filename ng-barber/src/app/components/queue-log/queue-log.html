<div class="bg-color">
    <div class="container">
        <div class="table-wrapper">

            <!-- หัวข้อ + search -->
            <div class="d-flex align-items-center justify-content-start">
                <h3 class="queue-title">ประวัติการจองคิว</h3>
            </div>

            <div class="d-flex justify-content-between ">
                <div class="filter-bar w-100">
                    <div class="filter-item">
                        <label class="form-label mb-1">วันที่เริ่ม</label>
                        <input type="date" class="form-control filter-input" [(ngModel)]="startDate"
                            (ngModelChange)="onSearchChanged()" />
                    </div>

                    <div class="filter-item">
                        <label class="form-label mb-1">วันที่สิ้นสุด</label>
                        <input type="date" class="form-control filter-input" [(ngModel)]="endDate"
                            (ngModelChange)="onSearchChanged()" />
                    </div>

                    <div class="filter-item">
                        <label class="form-label mb-1">ช่าง</label>
                        <select class="form-select filter-input" [(ngModel)]="selectedBarberId"
                            (ngModelChange)="onSearchChanged()">
                            <option [ngValue]="0">ทั้งหมด</option>
                            <option *ngFor="let barber of barberNames" [value]="barber.barberId">{{ barber.name }}
                            </option>
                        </select>
                    </div>

                    <div class="filter-item">
                        <label class="form-label mb-1">บริการ</label>
                        <select class="form-select filter-input" [(ngModel)]="selectedServiceId"
                            (ngModelChange)="onSearchChanged()">
                            <option [ngValue]="0">ทั้งหมด</option>
                            <option *ngFor="let service of services" [ngValue]="service.serviceId">
                                {{ getServiceNameThai(service.serviceId) }}
                            </option>
                        </select>
                    </div>


                    <div class="filter-item">
                        <label class="form-label mb-1">สถานะ</label>
                        <select class="form-select filter-input" [(ngModel)]="selectedStatus"
                            (ngModelChange)="onSearchChanged()">
                            <option value="">ทั้งหมด</option>
                            <option value="queuing">กำลังรอคิว</option>
                            <option value="done">เสร็จสิ้น</option>
                            <option value="canceled">ยกเลิก</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="d-flex align-items-center justify-content-start">
                <div class="text-white">
                    {{ queues.length === 0 ? 'ไม่มีรายการ'
                    : 'แสดงรายการที่ ' + ((page * size) + 1) + ' ถึง ' + ((page * size) + queues.length) + '
                    จากทั้งหมด ' +
                    totalElements }}
                </div>
            </div>

            <!-- Table Scroll -->
            <div class="table-scroll">
                <div class="div-table">

                    <!-- Header -->
                    <div class="div-table-row header">
                        <div class="div-table-cell">ลำดับที่</div>
                        <div class="div-table-cell">วัน-เวลาที่จองคิว</div>
                        <div class="div-table-cell">หมายเลขคิว</div>
                        <div class="div-table-cell">ประเภทบริการ</div>
                        <div class="div-table-cell">ชื่อลูกค้า</div>
                        <div class="div-table-cell">ช่าง</div>
                        <div class="div-table-cell">วัน-เวลาที่แก้ไขล่าสุด</div>
                        <div class="div-table-cell">ผู้แก้ไข</div>
                        <div class="div-table-cell">สถานะ</div>
                    </div>

                    <!-- Rows -->
                    <div class="div-table-row" *ngFor="let queue of queues; let i = index">
                        <div class="div-table-cell">{{ (page * size) + i + 1 }}</div>
                        <div class="div-table-cell">{{formatTimestampToThaiDateTime(queue.dateTime)}}</div>
                        <div class="div-table-cell">{{queue.queueNumber}}</div>
                        <div class="div-table-cell">{{getServiceNameThai(queue.serviceId)}}</div>
                        <div class="div-table-cell">{{getCustomerNameFromAccountId(queue.accountId)}}</div>
                        <div class="div-table-cell">{{getBarberNameFromBarberId(queue.barberId)}}</div>
                        <div class="div-table-cell">{{formatTimestampToThaiDateTime(queue.latestEdit)}}</div>
                        <div class="div-table-cell">{{getEditorNameFromId(queue.editedBy)}}</div>
                        <div class="div-table-cell">
                            <div class="queue-status" [ngClass]="{'queueing': queue.status === 'queuing',
                                                                            'done': queue.status === 'done',
                                                                            'canceled': queue.status === 'canceled'
                                                                            }">
                                {{ translateStatus(queue.status) }}
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Pagination -->
            <div class="d-flex justify-content-center mt-3">
                <app-pagination [totalPages]="totalPages" [currentPage]="pageCurrent"
                    (pageChange)="onPageChange($event)"></app-pagination>
            </div>

        </div>
    </div>
</div>