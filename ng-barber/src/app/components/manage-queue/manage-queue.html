<div class="bg-color">

  <div *ngIf="!queueAccepted">
    <div class="container">
      <div class="table-wrapper">

        <!-- หัวข้อ + search -->
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h3 class="queue-title">คิวของคุณ</h3>
        </div>

        <div class="ms-3">
          <p class="queue-count text-white">ทั้งหมด {{ myQueues.length }} คิว</p>
        </div>

        <!-- Table Scroll -->
        <div class="table-scroll">
          <div class="div-table">

            <!-- Header -->
            <div class="div-table-row header">
              <div class="div-table-cell">หมายเลขคิว</div>
              <div class="div-table-cell">ประเภทบริการ</div>
            </div>

            <!-- Rows -->
            <div class="div-table-row" *ngFor="let queue of myQueues" (click)="selectQueue(queue.queueId!)"
              [class.selected]="queue.queueId === selectedQueue">
              <div class="div-table-cell">{{queue.queueNumber}}</div>
              <div class="div-table-cell">{{getServiceNameThai(queue.serviceId!)}}</div>
            </div>

            <div *ngIf="myQueues.length === 0" class="div-table-row">
              <div class="div-table-cell text-center">
                ยังไม่มีคิวในวันนี้
              </div>
              <div class="div-table-cell text-center">-</div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>


  <div class="container" *ngIf="queueAccepted">
    <div class="queue-card">
      <div class="left-panel">
        <div class="queue-box">
          <h3>คิวที่ <span>{{currentQueue?.queueNumber}}</span></h3>
          เหลือ {{laterQueueCount}} คิว
        </div>

        <div class="button-group">
          <button class="btn-finish" data-bs-toggle="modal" data-bs-target="#doneModal">เสร็จสิ้น</button>
          <button class="btn-back" (click)="returnToAllQueues()">ย้อนกลับ</button>
        </div>
      </div>

      <div class="info-box">
        <h3>คุณ {{ currentQueueAccountInfo?.firstName }} {{ currentQueueAccountInfo?.lastName }}</h3>
        <p><strong>เบอร์โทรศัพท์:</strong> {{ currentQueueAccountInfo?.telNumber }}</p>
        <p><strong>ประเภทบริการ:</strong> {{getServiceNameThai(currentQueue?.serviceId!)}}</p>
      </div>
    </div>
  </div>
</div>

<!-- Modal จ่ายเงิน -->
<div class="modal fade" id="doneModal" tabindex="-1" aria-labelledby="doneModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-4 rounded-4 border-0 shadow-lg">

      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="fw-bold mb-0">ยืนยันการชำระเงินจากลูกค้า</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <form [formGroup]="paymentForm" (ngSubmit)="onSubmitDone()">

        <div class="mb-3">
          <label class="form-label">ชื่อลูกค้า</label>
          <input type="text" class="form-control bg-light"
            placeholder="{{ currentQueueAccountInfo?.firstName }} {{ currentQueueAccountInfo?.lastName }}" readonly>
        </div>

        <div class="mb-3">
          <label class="form-label">เบอร์โทรศัพท์</label>
          <input type="text" class="form-control bg-light" placeholder="{{ currentQueueAccountInfo?.telNumber }}"
            readonly>
        </div>

        <div class="mb-3">
          <label class="form-label">บริการ</label>
          <input type="text" class="form-control bg-light" formControlName="queueService"
            placeholder="{{getServiceNameThai(currentQueue?.serviceId!)}}" readonly>
        </div>

        <div class="text-end">
          <button type="submit" class="btn btn-primary" [disabled]="paymentForm.invalid" data-bs-dismiss="modal">
            ยืนยัน
          </button>
        </div>

      </form>

    </div>
  </div>
</div>